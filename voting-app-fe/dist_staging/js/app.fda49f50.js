(function(){"use strict";var e={1931:function(e,t,n){var l=n(5130),a=n(6768),i=n(4775);function s(e,t,n,l,s,o){const u=(0,a.g2)("screen-loading"),r=(0,a.g2)("list-dialog"),d=(0,a.g2)("list-popup"),c=(0,a.g2)("router-view");return(0,a.uX)(),(0,a.Wv)(i.E,null,{default:(0,a.k6)((()=>[(0,a.bF)(u),(0,a.bF)(r),(0,a.bF)(d),(0,a.bF)(c)])),_:1})}const o={class:"screen-loading"};function u(e,t,n,i,s,u){return(0,a.bo)(((0,a.uX)(),(0,a.CE)("div",o,t[0]||(t[0]=[(0,a.Lk)("div",{class:"spinner"},null,-1)]),512)),[[l.aG,i.isLoading]])}var r=n(6892),d={name:"ScreenLoading",components:{},setup(){const e=(0,r.Pj)(),t=(0,a.EW)((()=>e.getters["common/isLoading"]));return{isLoading:t}}},c=n(1241);const m=(0,c.A)(d,[["render",u],["__scopeId","data-v-a55370e6"]]);var p=m,v=n(4232),f=n(554),g=n(2729),h=n(1606),w=n(697),b=n(3745),k=n(1772);function y(e,t,n,l,i,s){return(0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(l.dialogs,(e=>((0,a.uX)(),(0,a.Wv)(k.p,{persistent:"",key:e.id,modelValue:e.visible,"onUpdate:modelValue":t=>e.visible=t,"max-width":"500"},{default:(0,a.k6)((()=>[(0,a.bF)(g.J,null,{default:(0,a.k6)((()=>[(0,a.bF)(h.r,null,{default:(0,a.k6)((()=>[(0,a.eW)((0,v.v_)(e.title),1)])),_:2},1024),(0,a.bF)(w.O,null,{default:(0,a.k6)((()=>[(0,a.eW)((0,v.v_)(e.content),1)])),_:2},1024),(0,a.bF)(b.S,null,{default:(0,a.k6)((()=>[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(e.buttons,(t=>((0,a.uX)(),(0,a.Wv)(f.D,{color:t.color,key:t.value,onClick:n=>l.handleButtonClick(e,t)},{default:(0,a.k6)((()=>[(0,a.eW)((0,v.v_)(t.text),1)])),_:2},1032,["color","onClick"])))),128))])),_:2},1024)])),_:2},1024)])),_:2},1032,["modelValue","onUpdate:modelValue"])))),128)}n(4114);var x=n(144),C=n(6217);let E=null,S=null;var D={initDialog(e){E=e},initPopup(e){S=e},async showDialog(e,t,n){const l=await E({title:e,content:t,buttons:n});return l},async showPopup({component:e,metaData:t}){const n=await S({component:e,metaData:t});return n},formatDateTimeIntl(e){e=new Date(e);const t={day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1};return new Intl.DateTimeFormat("en-GB",t).format(e).replace(",","")},loadSource(e){return window.cdnSite?window.cdnSite+e:e}},L={name:"ListDialog",components:{},setup(){const e=(0,x.KR)([]);function t(e,t){e.visible=!1,e.resolve(t.value)}return(0,a.sV)((()=>{D.initDialog((({title:t,content:n,buttons:l})=>new Promise((a=>{e.value.push({title:t,content:n,buttons:l,visible:!0,resolve:a,id:C.u.v1()})}))))})),{dialogs:e,handleButtonClick:t}}};const V=(0,c.A)(L,[["render",y]]);var A=V;function T(e,t,n,l,i,s){return(0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(l.popups,(e=>((0,a.uX)(),(0,a.Wv)(k.p,{persistent:"",key:e.id,modelValue:e.visible,"onUpdate:modelValue":t=>e.visible=t},{default:(0,a.k6)((()=>[((0,a.uX)(),(0,a.Wv)((0,a.$y)(e.component),{popup:e,class:"popup"},null,8,["popup"]))])),_:2},1032,["modelValue","onUpdate:modelValue"])))),128)}var I={name:"ListPopup",components:{},setup(){const e=(0,x.KR)([]);return(0,a.sV)((()=>{D.initPopup((({component:t,metaData:n})=>new Promise((l=>{e.value.push({component:t,metaData:n,visible:!0,resolve:l,id:C.u.v1()})}))))})),{popups:e}}};const R=(0,c.A)(I,[["render",T]]);var q=R,F={name:"App",components:{ScreenLoading:p,ListDialog:A,ListPopup:q},data:()=>({})};const _=(0,c.A)(F,[["render",s]]);var X=_,j=n(1387);const W={class:"login-container flex items-center justify-center h-[100vh]"},K={class:"login-content flex items-stretch justify-start rounded-lg overflow-hidden"},Q={class:"w-[384px]"},N=["src"],O={class:"flex items-center justify-center bg-white px-8"},M={class:"flex flex-col items-center"},U={class:"relative"};function B(e,t,n,l,i,s){return(0,a.uX)(),(0,a.CE)("div",W,[(0,a.Lk)("div",K,[(0,a.Lk)("div",Q,[(0,a.Lk)("img",{class:"object-contain",src:l.commonFunction.loadSource("/login.png"),alt:"voting image"},null,8,N)]),(0,a.Lk)("div",O,[(0,a.Lk)("div",M,[t[1]||(t[1]=(0,a.Lk)("h1",{class:"text-intro mb-5"},"Phầm mềm bỏ phiếu online",-1)),(0,a.Lk)("div",U,[(0,a.Lk)("button",{class:"w-80",id:"button-login-google",onClick:t[0]||(t[0]=(...t)=>e.loginWithGoogle&&e.loginWithGoogle(...t))})])])])])])}var P=n(4373);const $=()=>({isLoading:!1}),J={setIsLoading(e,t){e.isLoading=t}},G={isLoading(e){return e.isLoading}};var H={namespaced:!0,state:$,mutations:J,getters:G};n(1454);const z=()=>({stepOne:{voteTitle:"",voteTime:0,isSendQrEmail:!1,isRequireName:!1,totalJoiner:null,emails:[]},stepTwo:{currentQuestion:{questionTitle:null,isMultiAnswer:!1,isAnswerAddable:!1,answers:[],id:null},questions:[]}}),Y={reset(e){e.stepOne={voteTitle:"",voteTime:0,isSendQrEmail:!1,isRequireName:!1,totalJoiner:null,emails:[]},e.stepTwo={currentQuestion:{questionTitle:null,isMultiAnswer:!1,isAnswerAddable:!1,answers:[],id:null},questions:[]}},setStepOne(e,{value:t,field:n}){e.stepOne[n]=t},setStepTwo(e,{value:t,field:n}){e.stepTwo.currentQuestion[n]=t},setQuestions(e,t){e.stepTwo.questions=t},resetCurrentQuestion(e){e.stepTwo.currentQuestion={questionTitle:null,isMultiAnswer:!1,isAnswerAddable:!1,answers:[],id:null}}},Z={stepOne(e){return e.stepOne},stepTwo(e){return e.stepTwo.currentQuestion},questions(e){return e.stepTwo.questions},voteEntity(e){const t={...e.stepOne,emails:e.stepOne.emails.map((e=>({emailAddress:e}))),questions:e.stepTwo.questions.map((e=>({...e,answers:e.answers.map((e=>({answerContent:e,resultDetails:[]})))}))),results:[]};return t}};var ee={namespaced:!0,state:z,mutations:Y,getters:Z};const te=(0,r.y$)({modules:{common:H,addnew:ee}});var ne=te;function le(e){const t=ae(e);return t.interceptors.response.use((e=>e),(async e=>{401===e.response.status&&(ne.commit("common/setIsLoading",!1),await D.showDialog("Thông báo","Phiên làm việc của bạn đã hết. Vui lòng đăng nhập lại.",[{text:"Đồng ý",value:!0,color:"primary"}]),window.location.href="/login")})),t}function ae(e){const t=P.A.create({baseURL:`${window.appConfig.baseUrl}${e?`/${e}`:""}`,headers:{"Content-Type":"application/json"}});return t.interceptors.request.use((e=>{const t=localStorage.getItem("jwt-token");return t&&(e.headers["Authorization"]=`Bearer ${t}`),e})),t}const ie=ae("Auth"),se=le("Auth");var oe={async loginWithGoogle(e){const{data:t}=await ie.post("/login",JSON.stringify(e));return t},async checkSigninedHandleAuth(){const{data:e}=await se.get("/");return e},async checkSignined(){const{data:e}=await ie.get("/");return e}},ue={name:"LoginPage",components:{},setup(){const e=(0,j.rd)(),t=(0,r.Pj)();async function n(n){const l=n.credential;t.commit("common/setIsLoading",!0);const a=await oe.loginWithGoogle(l);localStorage.setItem("jwt-token",a),document.cookie=`vta_token=${a}; path=/; domain=votingapp.online`,t.commit("common/setIsLoading",!1),e.push("/"),window.location.reload()}return(0,a.sV)((async()=>{const t=localStorage.getItem("jwt-token");if(t)try{return await oe.checkSignined(),void e.push("/")}catch(l){console.log("token cũ")}window.google.accounts.id.initialize({client_id:window.appConfig.googleClientKey,callback:n}),window.google.accounts.id.renderButton(document.getElementById("button-login-google"),{}),window.google.accounts.id.prompt()})),{commonFunction:D}}};const re=(0,c.A)(ue,[["render",B],["__scopeId","data-v-80425636"]]);var de=re;const ce={class:"h-12 bg-white"},me={style:{height:"calc(100vh - 48px)"},class:"flex items-stretch justify-start flex-wrap overflow-hidden"},pe={style:{width:"204px"}},ve={style:{width:"calc(100% - 204px)"}};function fe(e,t,n,l,i,s){const o=(0,a.g2)("top-nav-vue"),u=(0,a.g2)("side-bar-vue"),r=(0,a.g2)("router-view");return(0,a.uX)(),(0,a.CE)("div",null,[(0,a.Lk)("div",ce,[(0,a.bF)(o)]),(0,a.Lk)("div",me,[(0,a.Lk)("div",pe,[(0,a.bF)(u)]),(0,a.Lk)("div",ve,[(0,a.bF)(r)])])])}const ge={class:"topnav"},he={class:"flex items-center justify-start"},we={class:"w-12 mt-[-4px]"},be=["src"],ke={class:"flex items-center"};function ye(e,t,n,l,i,s){return(0,a.uX)(),(0,a.CE)("div",ge,[(0,a.Lk)("div",he,[(0,a.Lk)("div",we,[(0,a.Lk)("img",{src:l.commonFunction.loadSource("/logo.png"),alt:""},null,8,be)]),t[0]||(t[0]=(0,a.Lk)("h1",{class:"font-medium text-[24px]"},"Voting App",-1))]),(0,a.Lk)("div",ke,[(0,a.bF)(f.D,{onClick:l.handleLogout,color:"secondary"},{default:(0,a.k6)((()=>t[1]||(t[1]=[(0,a.eW)("THOÁT")]))),_:1},8,["onClick"])])])}var xe={name:"App",components:{},setup(){const e=(0,j.rd)();function t(){localStorage.removeItem("jwt-token"),document.cookie="vta_token=v; path=/; domain=votingapp.online",e.push("/login")}return{handleLogout:t,commonFunction:D}}};const Ce=(0,c.A)(xe,[["render",ye],["__scopeId","data-v-6a25d507"]]);var Ee=Ce;const Se={class:"sidebar pl-3 pr-2 py-5"},De={class:"w-8"},Le=["src"],Ve={class:"text-lg font-medium"};function Ae(e,t,n,l,i,s){const o=(0,a.g2)("router-link");return(0,a.uX)(),(0,a.CE)("div",Se,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(l.items,(e=>((0,a.uX)(),(0,a.Wv)(o,{to:e.route,class:"sidebar-item flex items-center justify-start gap-x-3 cursor-pointer px-2 py-2 rounded-md","active-class":"isActive",key:e.id},{default:(0,a.k6)((()=>[(0,a.Lk)("div",De,[(0,a.Lk)("img",{src:l.commonFunction.loadSource(e.iconSrc),alt:""},null,8,Le)]),(0,a.Lk)("div",Ve,(0,v.v_)(e.text),1)])),_:2},1032,["to"])))),128))])}var Te={name:"App",components:{},setup(){const e=(0,x.KR)([{text:"Danh sách",iconSrc:"/icon/listVoted.svg",id:"listVote",route:"/app/list",isActive:!0},{text:"Thêm mới",iconSrc:"/icon/addVote.svg",route:"/app/new",id:"addNew"}]);return{items:e,commonFunction:D}}};const Ie=(0,c.A)(Te,[["render",Ae]]);var Re=Ie,qe=n(6912);qe.t1.register(...qe.$L);var Fe={name:"MainLayout",components:{TopNavVue:Ee,SideBarVue:Re},setup(){(0,a.KC)((async()=>{const e=localStorage.getItem("jwt-token")??"";await oe.checkSigninedHandleAuth(e)}))}};const _e=(0,c.A)(Fe,[["render",fe]]);var Xe=_e,je=n(1262),We=n(8924),Ke=n(5728),Qe=n(4366),Ne=n(8050);const Oe={class:"max-h-[400px]"},Me={key:0,class:"cell-check"},Ue={key:1,class:"cell-uncheck"},Be={key:0,class:"cell-check"},Pe={key:1,class:"cell-uncheck"};function $e(e,t,n,l,i,s){return(0,a.uX)(),(0,a.CE)("div",Oe,[(0,a.bF)(je.Py,{search:l.textSearch,headers:l.headers,"onClick:row":l.handleClick,items:l.items,height:"calc(100vh - 180px)",class:"table"},{top:(0,a.k6)((()=>[(0,a.bF)(Qe.u,{flat:""},{default:(0,a.k6)((()=>[(0,a.bF)(Ne.s,null,{default:(0,a.k6)((()=>t[1]||(t[1]=[(0,a.eW)("Dánh sách cuộc bình chọn")]))),_:1}),(0,a.bF)(We.h),(0,a.bF)(Ke.W,{modelValue:l.textSearch,"onUpdate:modelValue":t[0]||(t[0]=e=>l.textSearch=e),"append-icon":"mdi-magnify",label:"Tìm kiếm","single-line":"","hide-details":""},null,8,["modelValue"])])),_:1})])),["item.isRequireName"]:(0,a.k6)((({item:e})=>[e.isRequireName?((0,a.uX)(),(0,a.CE)("div",Me,t[2]||(t[2]=[(0,a.Lk)("i",{class:"fa-solid fa-check"},null,-1)]))):((0,a.uX)(),(0,a.CE)("div",Ue,t[3]||(t[3]=[(0,a.Lk)("i",{class:"fa-solid fa-xmark"},null,-1)])))])),["item.isSendQrEmail"]:(0,a.k6)((({item:e})=>[e.isSendQrEmail?((0,a.uX)(),(0,a.CE)("div",Be,t[4]||(t[4]=[(0,a.Lk)("i",{class:"fa-solid fa-check"},null,-1)]))):((0,a.uX)(),(0,a.CE)("div",Pe,t[5]||(t[5]=[(0,a.Lk)("i",{class:"fa-solid fa-xmark"},null,-1)])))])),_:2},1032,["search","headers","onClick:row","items"])])}var Je=n(1161);const Ge={class:"bg-white rounded-md px-5 py-3 w-[600px]"},He={class:"text-lg"},ze={class:"flex items-center justify-start gap-x-4"},Ye={class:""},Ze={class:"flex items-center justify-start gap-x-1"},et={key:0,class:"fa-solid fa-check"},tt={key:1,class:"fa-solid fa-xmark"},nt={class:"mt-5"},lt={class:"flex items-center justify-center text-base"},at={class:"text-center"},it={class:"flex items-center justify-center"},st={class:"relative"},ot={class:"flex items-center justify-center absolute inset-0 qr-blur"},ut={class:"flex justify-end gap-x-3 mt-5"};function rt(e,t,n,i,s,o){const u=(0,a.g2)("countdown-timer");return(0,a.uX)(),(0,a.CE)("div",Ge,[(0,a.Lk)("h1",He,(0,v.v_)(i.voteEntity.voteTitle),1),(0,a.Lk)("div",ze,[(0,a.Lk)("div",Ye,"Số lượng câu hỏi: "+(0,v.v_)(i.voteEntity.questions?.length),1),(0,a.bo)((0,a.Lk)("div",{class:""},"Số người tham gia: "+(0,v.v_)(i.voteEntity?.totalJoiner),513),[[l.aG,i.voteEntity?.totalJoiner]]),(0,a.Lk)("div",Ze,[t[2]||(t[2]=(0,a.Lk)("div",null,"Yêu cầu nhập tên: ",-1)),(0,a.Lk)("div",{class:(0,v.C4)((i.voteEntity.isRequireName?"text-green-600":"text-red-600")+" mb-[-1px]")},[i.voteEntity.isRequireName?((0,a.uX)(),(0,a.CE)("i",et)):((0,a.uX)(),(0,a.CE)("i",tt))],2)])]),(0,a.Lk)("div",null,[(0,a.Lk)("div",null,"Tổng thời gian bình chọn: "+(0,v.v_)(i.voteEntity?.voteTime)+" phút",1)]),(0,a.Lk)("div",nt,[(0,a.Lk)("div",lt,[i.voteEntity.createdDate?((0,a.uX)(),(0,a.Wv)(u,{key:0,modelValue:i.leftTime,"onUpdate:modelValue":t[0]||(t[0]=e=>i.leftTime=e),startTime:i.voteEntity.createdDate,durationMinutes:i.voteEntity.voteTime,isStoped:2==i.voteEntity.voteStatus},null,8,["modelValue","startTime","durationMinutes","isStoped"])):(0,a.Q3)("",!0)]),(0,a.Lk)("div",at,(0,v.v_)(i.url),1),(0,a.Lk)("div",it,[(0,a.bF)(Je.y,{text:"Tải xuống mã QR"},{activator:(0,a.k6)((({props:e})=>[(0,a.Lk)("div",st,[(0,a.bo)((0,a.Lk)("div",ot,t[3]||(t[3]=[(0,a.Lk)("div",{class:"font-bold text-lg"},"Hết hiệu lực",-1)]),512),[[l.aG,2==i.voteEntity.voteStatus||0==i.leftTime]]),(0,a.Lk)("canvas",(0,a.v6)({onClick:t[1]||(t[1]=(...e)=>i.downloadQRCode&&i.downloadQRCode(...e)),class:"cursor-pointer"},e,{ref:"qrcodeCanvasRef"}),null,16)])])),_:1})])]),(0,a.Lk)("div",ut,[(0,a.bF)(f.D,{disabled:2==i.voteEntity.voteStatus||0==i.leftTime,onClick:i.handleStop,class:"normal-case"},{default:(0,a.k6)((()=>t[4]||(t[4]=[(0,a.eW)(" Dừng bình chọn ")]))),_:1},8,["disabled","onClick"]),(0,a.bF)(f.D,{color:"primary",onClick:i.handleClose,class:"normal-case"},{default:(0,a.k6)((()=>t[5]||(t[5]=[(0,a.eW)("Đóng")]))),_:1},8,["onClick"])])])}ae("vote");const dt=le("vote");var ct={async createAsync(e){const{data:t}=await dt.post("/",e);return t},async getEntireAsync(e){const{data:t}=await dt.get(`/entire?id=${e}`);return t},async updateVoteStatusAsync(e,t){await dt.put(`/voteStatus?voteID=${e}&status=${t}`)},async getListByUserId(){const{data:e}=await dt.get("/list");return e}},mt=n(8420);function pt(e,t,n,l,i,s){return(0,a.uX)(),(0,a.CE)("div",null,[(0,a.Lk)("p",null,(0,v.v_)(l.formattedTime),1)])}function vt(e,t,n){const l=(0,x.KR)(""),i=(0,x.KR)(null),s=(0,x.KR)(null);function o(e,t){const n=Math.abs(e-t);return Math.floor(n/1e3)}function u(e){const t=Math.floor(e/3600),n=Math.floor(e%3600/60),l=e%60,a=String(t).padStart(2,"0"),i=String(n).padStart(2,"0"),s=String(l).padStart(2,"0");return`${a}:${i}:${s}`}return(0,a.nT)((()=>{n.value&&clearInterval(s.value)})),(0,a.sV)((()=>{s.value=setInterval((()=>{i.value=60*t-o(new Date,new Date(e)),i.value<0&&(i.value=0),l.value=u(i.value)}),1e3)})),(0,a.hi)((()=>{clearInterval(s.value)})),{formattedTime:l,lefttime:i}}n(9041);var ft={emits:["update:model-value","update:modelValue"],props:{startTime:{type:String,required:!0},durationMinutes:{type:Number,required:!0},isStoped:{type:Boolean,required:!0,default:!1},modelValue:{type:Number,required:!0}},setup(e,{emit:t}){const n=(0,x.KR)(!1),{formattedTime:l,lefttime:i}=vt(e.startTime,e.durationMinutes,n);return(0,a.wB)((()=>e.isStoped),((e,t)=>{n.value=e})),(0,a.wB)((()=>i.value),((e,n)=>{t("update:modelValue",e)})),{formattedTime:l,lefttime:i}}};const gt=(0,c.A)(ft,[["render",pt],["__scopeId","data-v-5dd88fba"]]);var ht=gt,wt={name:"QrCodePopup",components:{CountdownTimer:ht},props:{popup:{type:Object,required:!0}},setup(e){const t=(0,x.KR)({}),n=(0,x.KR)(null),l=(0,x.KR)(null),i=(0,x.KR)(null);async function s(){try{const e=n.value;l.value=`${window.location.origin}/submit/${t.value.voteID}`,await mt.toCanvas(e,l.value,{width:250})}catch(e){console.error("Lỗi khi sinh mã QR:",e)}}function o(){const e=n.value,t=document.createElement("a");t.href=e.toDataURL("image/png"),t.download="qrcode.png",t.click()}function u(){const t=e.popup.resolve;e.popup.visible=!1,t("1")}async function r(){t.value=await ct.getEntireAsync(e.popup?.metaData?.voteID)}async function d(){await ct.updateVoteStatusAsync(t.value.voteID,2),await r()}return(0,a.KC)((async()=>{await r()})),(0,a.sV)((()=>{setTimeout((()=>{s()}),1e3)})),{voteEntity:t,qrcodeCanvasRef:n,url:l,downloadQRCode:o,handleClose:u,handleStop:d,leftTime:i}}};const bt=(0,c.A)(wt,[["render",rt],["__scopeId","data-v-8a6e28f0"]]);var kt=bt;const yt={class:"bg-white rounded-md px-5 py-2 w-full"},xt={class:"detail-title"},Ct={class:"text-lg"},Et={class:"flex items-center justify-start gap-x-5"},St={key:0},Dt={key:0,class:"flex items-center justify-start gap-x-2"},Lt={class:"w-full gap-x-10 flex items-start justify-start px-10 py-2"},Vt={class:"text-center mt-3"},At={class:"flex justify-end mt-5 gap-x-4"};function Tt(e,t,n,l,i,s){const o=(0,a.g2)("countdown-timer"),u=(0,a.g2)("Pie");return(0,a.uX)(),(0,a.CE)("div",yt,[(0,a.Lk)("div",xt,[(0,a.Lk)("h1",Ct,(0,v.v_)(l.voteEntity?.voteTitle),1),(0,a.Lk)("div",Et,[(0,a.Lk)("div",null,"Số lượng câu hỏi: "+(0,v.v_)(l.chartdata?.length),1),(0,a.Lk)("div",null,"Số người đã trả lời: "+(0,v.v_)(l.voteEntity?.results?.length||0),1),l.voteEntity?.totalJoiner?((0,a.uX)(),(0,a.CE)("div",St,"Số người tham gia: "+(0,v.v_)(l.voteEntity?.totalJoiner),1)):(0,a.Q3)("",!0)]),2!=l.voteEntity?.voteStatus&&0!=l.lefttime?((0,a.uX)(),(0,a.CE)("div",Dt,[t[1]||(t[1]=(0,a.Lk)("div",null,"Thời gian còn lại: ",-1)),l.voteEntity?((0,a.uX)(),(0,a.Wv)(o,{key:0,modelValue:l.lefttime,"onUpdate:modelValue":t[0]||(t[0]=e=>l.lefttime=e),isStoped:!1,startTime:l.voteEntity?.createdDate,durationMinutes:l.voteEntity?.voteTime},null,8,["modelValue","startTime","durationMinutes"])):(0,a.Q3)("",!0)])):(0,a.Q3)("",!0),t[2]||(t[2]=(0,a.Lk)("div",{class:"mt-3"},null,-1))]),(0,a.Lk)("div",Lt,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(l.chartdata,((e,t)=>((0,a.uX)(),(0,a.CE)("div",{key:t,class:"w-[300px]"},[(0,a.bF)(u,{data:e,options:l.getChartOption(e.questionID)},null,8,["data","options"]),(0,a.Lk)("div",Vt,(0,v.v_)(e.title),1)])))),128))]),(0,a.Lk)("div",At,[l.voteEntity?.isSendQrEmail?(0,a.Q3)("",!0):((0,a.uX)(),(0,a.Wv)(f.D,{key:0,color:"secondary",class:"normal-case",onClick:l.showQrFormCode},{default:(0,a.k6)((()=>t[3]||(t[3]=[(0,a.eW)("Màn QR Code")]))),_:1},8,["onClick"])),(0,a.bF)(f.D,{color:"primary ",class:"normal-case",onClick:l.handleClose},{default:(0,a.k6)((()=>t[4]||(t[4]=[(0,a.eW)("Đóng")]))),_:1},8,["onClick"])])])}n(8992),n(4520),n(7550);var It=n(1010),Rt={name:"DetailVote",components:{Pie:It.Fq,CountdownTimer:ht},props:{popup:{type:Object,required:!0}},setup(e){const t=(0,x.KR)(e.popup.metaData.voteID),n=(0,x.KR)(null),l=(0,j.rd)(),i=(0,x.KR)(null),s=(0,x.KR)({responsive:!0,plugins:{legend:{onClick:null},tooltip:{enabled:!0}},onClick:(e,t)=>{if(t.length>0||n.value?.isRequireName||n.value?.isSendQrEmail){const n=t[0].index;console.log(n,e,t,o.value)}}}),o=(0,a.EW)((()=>{const e=n.value?.questions;return e?e.map((e=>{const t=e.questionTitle,n=e.answers.map((e=>e.answerContent)),l=e.answers.map((e=>e.answerID)),a=e.answers.map((e=>e.resultDetails.length));return{labels:n,datasets:[{data:a}],title:t,questionID:e.questionID,labelsIds:l}})):[]})),u=(0,a.EW)((()=>[{value:1,text:"Tổng quan"},{value:2,text:"Chi tiết"}]));function r(){l.push("/app/list");const t=e.popup.resolve;e.popup.visible=!1,t("1")}function d(e){return{responsive:!0,plugins:{legend:{onClick:null},tooltip:{enabled:!0}},onClick:(t,n)=>c(n,e)}}async function c(e,t){if(e.length>0||n.value?.isRequireName||n.value?.isSendQrEmail){const l=e[0]?.index;if(console.log(l),null===l||void 0===l)return;const a=o.value.filter((e=>e.questionID==t))[0],i=a.labelsIds[l],s=n.value?.results?.filter((e=>e.resultDetails.some((e=>e.answerID==i))))||[];let u=[];u=n.value?.isSendQrEmail?n.value?.emails.filter((e=>s.some((t=>t.emailID==e.emailID)))).map((e=>e.emailAddress)):s.map((e=>e.submitterName)),await D.showDialog("Danh sách người đã chọn câu trả lời",u.join(", "),[{text:"Đóng",value:1,color:"primary"}])}}async function m(){await D.showPopup({component:kt,metaData:{voteID:n.value.voteID}}),n.value=await ct.getEntireAsync(t.value)}return(0,a.KC)((async()=>{n.value=await ct.getEntireAsync(t.value)})),{voteID:t,option:s,chartdata:o,handleClose:r,voteEntity:n,tabs:u,getChartOption:d,lefttime:i,showQrFormCode:m}}};const qt=(0,c.A)(Rt,[["render",Tt]]);var Ft=qt,_t={name:"VotingPage",components:{},setup(){const e=(0,x.KR)([]),t=(0,x.KR)(null),n=(0,j.rd)(),l=(0,j.lq)();function i(e,{item:t}){n.push(`/app/list?voteID=${t.voteID}`)}const s=(0,a.EW)((()=>[{title:"Tiêu đề",key:"voteTitle",align:"start"},{title:"Thời gian bắt đầu",key:"createdDate",align:"center"},{title:"Thời gian bình chọn",key:"voteTime",align:"center"},{title:"Xác thực bằng email",key:"isSendQrEmail",align:"center"},{title:"Bắt buộc nhập tên",key:"isRequireName",align:"center"},{title:"Số người tham gia",key:"totalJoiner",align:"center"}])),o=(0,a.EW)((()=>l.query?.voteID));(0,a.wB)((()=>o.value),(()=>{o.value&&D.showPopup({component:Ft,metaData:{voteID:o.value}})})),(0,a.sV)((async()=>{e.value=await ct.getListByUserId(),o.value&&D.showPopup({component:Ft,metaData:{voteID:o}})}));const u=(0,a.EW)((()=>e.value.map((e=>({...e,createdDate:D.formatDateTimeIntl(e.createdDate)})))));return{headers:s,textSearch:t,items:u,handleClick:i}}};const Xt=(0,c.A)(_t,[["render",$e]]);var jt=Xt;const Wt={class:"px-5 py-2 h-full flex flex-col"},Kt={class:"step-item flex items-center justify-center"},Qt={class:"step-item"};function Nt(e,t,n,i,s,o){const u=(0,a.g2)("step-by-step"),r=(0,a.g2)("add-new-step-one"),d=(0,a.g2)("add-new-step-two");return(0,a.uX)(),(0,a.CE)("div",Wt,[(0,a.bF)(u,{isDone:i.isDone,steps:i.steps,modelValue:i.currentStepIndex,"onUpdate:modelValue":t[0]||(t[0]=e=>i.currentStepIndex=e)},null,8,["isDone","steps","modelValue"]),(0,a.bo)((0,a.Lk)("div",Kt,[(0,a.bF)(r,{onSubmit:t[1]||(t[1]=e=>i.currentStepIndex=i.currentStepIndex+1)})],512),[[l.aG,0==i.currentStepIndex]]),(0,a.bo)((0,a.Lk)("div",Qt,[(0,a.bF)(d,{onSubmit:i.handleSubmitStepTwo},null,8,["onSubmit"])],512),[[l.aG,i.currentStepIndex>0]])])}const Ot={class:"flex items-start justify-start"},Mt={class:"text-lg font-medium px-8"},Ut=["disabled"];function Bt(e,t,n,i,s,o){return(0,a.uX)(),(0,a.CE)("div",Ot,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(n.steps,((e,t)=>((0,a.uX)(),(0,a.CE)("div",{key:t},[(0,a.Lk)("div",null,[(0,a.Lk)("div",Mt,[(0,a.Lk)("div",null," Bước "+(0,v.v_)(t+1)+": "+(0,v.v_)(e.title),1)]),(0,a.Lk)("div",{class:(0,v.C4)(["step-foot relative",[{isActive:n.modelValue>t}]])},[(0,a.Lk)("div",{class:(0,v.C4)(["step-dot step-dot-first",[{isActive:n.modelValue>=t}]])},null,2),(0,a.bo)((0,a.Lk)("div",{class:(0,v.C4)(["step-dot step-dot-last",[{isActive:n.modelValue==n.steps.length}]])},null,2),[[l.aG,t==n.steps.length-1]])],2)])])))),128)),(0,a.bF)(Je.y,{text:"Quay lại"},{activator:(0,a.k6)((({props:e})=>[(0,a.Lk)("button",(0,a.v6)({onClick:t[0]||(t[0]=(...e)=>i.handleBackStep&&i.handleBackStep(...e)),disabled:0==n.modelValue||n.isDone,class:"icon-direct"},e),t[1]||(t[1]=[(0,a.Lk)("i",{class:"fas fa-arrow-left"},null,-1)]),16,Ut)])),_:1})])}var Pt={name:"StepByStep",emits:["update:modelValue","backStep"],components:{},props:{modelValue:{type:Number,required:!0},steps:{type:Array,required:!0},isDone:{type:Boolean,required:!0,default:!1}},setup(e,{emit:t}){const n=e=>{t("update:modelValue",e)};function l(){const l=e.modelValue;n(l-1),t("backStep")}return{updateValue:n,handleBackStep:l}}};const $t=(0,c.A)(Pt,[["render",Bt],["__scopeId","data-v-31246ce3"]]);var Jt=$t,Gt=n(2239),Ht=n(276),zt=n(1560);const Yt={class:"px-5 py-4 border border-[#ccc] rounded-md"},Zt={class:"flex items-center justify-start gap-x-5"},en={class:"flex justify-end"};function tn(e,t,n,i,s,o){return(0,a.uX)(),(0,a.CE)("div",Yt,[(0,a.bF)(zt.n,{class:"w-[500px] flex flex-col gap-y-4 max-h-[500px] overflow-y-auto",ref:"formRef",modelValue:i.isFormValid,"onUpdate:modelValue":t[6]||(t[6]=e=>i.isFormValid=e)},{default:(0,a.k6)((()=>[(0,a.bF)(Ke.W,{rules:i.requireStringRule,modelValue:i.voteTitle,"onUpdate:modelValue":t[0]||(t[0]=e=>i.voteTitle=e),placeholder:"Tiêu đề cuộc bình chọn",clearable:""},null,8,["rules","modelValue"]),(0,a.bF)(Ke.W,{label:"Thời gian bình chọn",modelValue:i.voteTime,"onUpdate:modelValue":t[1]||(t[1]=e=>i.voteTime=e),modelModifiers:{number:!0},type:"number",rules:[...i.requireNumberRule,...i.numberRules]},null,8,["modelValue","rules"]),i.isSendQrEmail?(0,a.Q3)("",!0):((0,a.uX)(),(0,a.Wv)(Ke.W,{key:0,label:"Số lượng người tham gia",modelValue:i.totalJoiner,"onUpdate:modelValue":t[2]||(t[2]=e=>i.totalJoiner=e),modelModifiers:{number:!0},type:"number",rules:i.numberRules},null,8,["modelValue","rules"])),(0,a.Lk)("div",Zt,[(0,a.bF)(Ht.a,{modelValue:i.isSendQrEmail,"onUpdate:modelValue":t[3]||(t[3]=e=>i.isSendQrEmail=e),label:"Gửi QR qua Email"},null,8,["modelValue"]),(0,a.bo)((0,a.bF)(Ht.a,{modelValue:i.isRequireName,"onUpdate:modelValue":t[4]||(t[4]=e=>i.isRequireName=e),label:"Bắt buộc nhập Tên"},null,8,["modelValue"]),[[l.aG,0==i.isSendQrEmail]])]),i.isSendQrEmail?((0,a.uX)(),(0,a.Wv)(Gt.V,{key:1,"item-value":"email","item-title":"email",onInput:i.handleChangeSearch,modelValue:i.emailList,"onUpdate:modelValue":t[5]||(t[5]=e=>i.emailList=e),items:i.emails,label:"Danh sách email",multiple:"",rules:i.selectRules,onBlur:i.handleBlueSearch},null,8,["onInput","modelValue","items","rules","onBlur"])):(0,a.Q3)("",!0),(0,a.Lk)("div",en,[(0,a.bF)(f.D,{color:"primary",onClick:i.submitForm},{default:(0,a.k6)((()=>t[7]||(t[7]=[(0,a.eW)("Bước tiếp theo")]))),_:1},8,["onClick"])])])),_:1},8,["modelValue"])])}const nn=[e=>isNaN(parseInt(e))||parseInt(e)>0||"Vui lòng nhập số lớn hơn không"],ln=[e=>(e||0===e)&&null!=e&&void 0!=e||"Không được để trống"],an=[e=>!!e?.trim()?.length||"Không được để trống"],sn=[e=>!!e?.length||"Chọn ít nhất một giá trị"],on=(ae("email"),le("email"));var un={async getByUserAsync(){const{data:e}=await on.get("/byUser");return e},async getByIdAsync(e){const{data:t}=await on.get(`/?emailID=${e}`);return t}};function rn(){const e=(0,x.KR)([]);return(0,a.KC)((async()=>{const t=await un.getByUserAsync();e.value=t.map((e=>({email:e,isCustom:!1})))})),{emailsByUser:e}}var dn={name:"AddNewStepOne",emits:["submit"],components:{},props:{},setup(e,{emit:t}){const n=(0,r.Pj)(),l=(0,x.KR)(null),i=(0,x.KR)(null),{emailsByUser:s}=rn(),o=(0,a.EW)({get:()=>n.getters["addnew/stepOne"].voteTitle,set:e=>n.commit("addnew/setStepOne",{field:"voteTitle",value:e})}),u=(0,a.EW)({get:()=>n.getters["addnew/stepOne"].voteTime,set:e=>n.commit("addnew/setStepOne",{field:"voteTime",value:e})}),d=(0,a.EW)({get:()=>n.getters["addnew/stepOne"].isSendQrEmail,set:e=>{n.commit("addnew/setStepOne",{field:"isSendQrEmail",value:e}),e&&(c.value=!1)}}),c=(0,a.EW)({get:()=>n.getters["addnew/stepOne"].isRequireName,set:e=>n.commit("addnew/setStepOne",{field:"isRequireName",value:e})}),m=(0,a.EW)({get:()=>n.getters["addnew/stepOne"].totalJoiner,set:e=>n.commit("addnew/setStepOne",{field:"totalJoiner",value:e})}),p=(0,a.EW)({get:()=>n.getters["addnew/stepOne"].emails,set:e=>n.commit("addnew/setStepOne",{field:"emails",value:e})}),v=async()=>{await l.value.validate(),i.value&&t("submit")};function f(e){const t=e.target.value;s.value.some((e=>e.email==t))||(s.value=s.value.filter((e=>!e.isCustom||p.value.some((t=>t==e.email)))),t&&s.value.push({email:t,isCustom:!0}))}function g(){s.value=s.value.filter((e=>!e.isCustom||p.value.some((t=>t==e.email))))}return{voteTime:u,totalJoiner:m,isRequireName:c,isSendQrEmail:d,emailList:p,numberRules:nn,requireNumberRule:ln,submitForm:v,formRef:l,emails:s,selectRules:sn,handleChangeSearch:f,handleBlueSearch:g,isFormValid:i,voteTitle:o,requireStringRule:an}}};const cn=(0,c.A)(dn,[["render",tn]]);var mn=cn;const pn={class:"h-full flex items-stretch justify-start gap-x-10"},vn={class:"flex items-stretch justify-between gap-x-2"},fn={class:"flex flex-col gap-y-3 answer-list overflow-y-auto"},gn=["onClick"],hn=["src"],wn={class:"mt-2 flex-grow flex items-end justify-end gap-x-3"},bn={class:"flex flex-col flex-grow"},kn={class:"flex flex-col question-list gap-y-4 items-stretch"},yn={class:"flex items-center justify-start gap-x-6 text-sm"},xn={class:"flex items-center justify-start gap-x-1"},Cn={key:0,class:"fa-solid fa-check"},En={key:1,class:"fa-solid fa-xmark"},Sn={class:"flex items-center justify-start gap-x-1"},Dn={key:0,class:"fa-solid fa-check"},Ln={key:1,class:"fa-solid fa-xmark"},Vn={class:"flex items-center justify-start gap-x-1"},An={class:"flex question-btn items-center justify-end gap-x-2 flex-grow opacity-0"},Tn={class:"flex-grow flex justify-end items-end"};function In(e,t,n,i,s,o){return(0,a.uX)(),(0,a.CE)("div",pn,[(0,a.bF)(zt.n,{class:"w-[600px] px-5 py-4 rounded-md border border-[#ccc] flex flex-col flex-shrink-0",ref:"formRef",modelValue:i.isFormAddQuestionValid,"onUpdate:modelValue":t[4]||(t[4]=e=>i.isFormAddQuestionValid=e)},{default:(0,a.k6)((()=>[(0,a.Lk)("div",null,[(0,a.bF)(Ke.W,{rules:i.requireStringRule,height:"40px",modelValue:i.questionTitle,"onUpdate:modelValue":t[0]||(t[0]=e=>i.questionTitle=e),placeholder:"Nội dung câu hỏi",clearable:""},null,8,["rules","modelValue"]),(0,a.bF)(Ht.a,{modelValue:i.isMultiAnswer,"onUpdate:modelValue":t[1]||(t[1]=e=>i.isMultiAnswer=e),label:"Cho phép chọn nhiều câu trả lời"},null,8,["modelValue"]),(0,a.bF)(Ht.a,{modelValue:i.isAnswerAddable,"onUpdate:modelValue":t[2]||(t[2]=e=>i.isAnswerAddable=e),label:"Cho phép tự thêm câu trả lời"},null,8,["modelValue"]),(0,a.Lk)("div",vn,[(0,a.bF)(Ke.W,{rules:i.validateAnswerRule,ref:"answerContentRef",modelValue:i.answerContent,"onUpdate:modelValue":t[3]||(t[3]=e=>i.answerContent=e),placeholder:"Nội dung câu trả lời",clearable:""},null,8,["rules","modelValue"]),(0,a.bF)(f.D,{color:"primary",class:"normal-case",height:"56px",disabled:!i.answerContent?.trim()?.length,onClick:i.addAnswer},{default:(0,a.k6)((()=>t[5]||(t[5]=[(0,a.eW)("Thêm mới")]))),_:1},8,["disabled","onClick"])]),(0,a.Lk)("div",fn,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(i.listAnswer,((e,t)=>((0,a.uX)(),(0,a.CE)("div",{class:"answer-item border border-[#ccc] px-3 py-1 rounded-md flex items-center justify-between gap-x-2",key:e},[(0,a.Lk)("div",null,(0,v.v_)(e),1),(0,a.bF)(Je.y,{text:"Xóa câu trả lời"},{activator:(0,a.k6)((({props:e})=>[(0,a.Lk)("div",(0,a.v6)({ref_for:!0},e,{onClick:e=>i.handleRemoveAnswer(t),class:"answer-item-remove w-6 flex-shrink-0 cursor-pointer"}),[(0,a.Lk)("img",{src:i.commonFunction.loadSource("/icon/close.svg"),alt:""},null,8,hn)],16,gn)])),_:2},1024)])))),128))])]),(0,a.Lk)("div",wn,[(0,a.bo)((0,a.bF)(f.D,{color:"secondary normal-case",onClick:i.handleDiscardEdit},{default:(0,a.k6)((()=>t[6]||(t[6]=[(0,a.eW)("Hủy")]))),_:1},8,["onClick"]),[[l.aG,i.questionId]]),(0,a.bF)(f.D,{onClick:i.submitQuestion,color:"primary",class:"mt-auto normal-case"},{default:(0,a.k6)((()=>[(0,a.eW)((0,v.v_)(i.questionId?"Sửa câu hỏi":"Thêm mới câu hỏi"),1)])),_:1},8,["onClick"])])])),_:1},8,["modelValue"]),(0,a.Lk)("div",bn,[(0,a.Lk)("div",kn,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(i.listQuestion,(e=>((0,a.uX)(),(0,a.CE)("div",{class:(0,v.C4)(["px-2 py-1 border border-[#ccc] rounded-md question-item",[{"bg-red-100":i.questionId==e.id}]]),key:e.questionTitle},[(0,a.bF)(Je.y,{text:e.questionTitle},{activator:(0,a.k6)((({props:t})=>[(0,a.Lk)("div",(0,a.v6)({ref_for:!0},t,{class:""}),(0,v.v_)(e.questionTitle),17)])),_:2},1032,["text"]),(0,a.Lk)("div",yn,[(0,a.Lk)("div",xn,[t[7]||(t[7]=(0,a.Lk)("div",null,"Chọn nhiều đáp án: ",-1)),(0,a.Lk)("div",{class:(0,v.C4)((e.isMultiAnswer?"text-green-600":"text-red-600")+" mb-[-1px]")},[e.isMultiAnswer?((0,a.uX)(),(0,a.CE)("i",Cn)):((0,a.uX)(),(0,a.CE)("i",En))],2)]),(0,a.Lk)("div",Sn,[t[8]||(t[8]=(0,a.Lk)("div",null,"Tự thêm đáp án: ",-1)),(0,a.Lk)("div",{class:(0,v.C4)((e.isAnswerAddable?"text-green-600":"text-red-600")+" mb-[-1px]")},[e.isAnswerAddable?((0,a.uX)(),(0,a.CE)("i",Dn)):((0,a.uX)(),(0,a.CE)("i",Ln))],2)]),(0,a.Lk)("div",Vn,[t[9]||(t[9]=(0,a.Lk)("div",null,"Số lượng đáp án: ",-1)),(0,a.Lk)("div",null,(0,v.v_)(e.answers.length),1)]),(0,a.Lk)("div",An,[(0,a.bF)(f.D,{color:"secondary",onClick:t=>i.handleEditQuestion(e.id),class:"normal-case custom-btn"},{default:(0,a.k6)((()=>t[10]||(t[10]=[(0,a.eW)("Sửa")]))),_:2},1032,["onClick"]),(0,a.bF)(f.D,{color:"red",onClick:t=>i.handleRemoveQuestion(e.id),class:"normal-case custom-btn"},{default:(0,a.k6)((()=>t[11]||(t[11]=[(0,a.eW)("Xóa")]))),_:2},1032,["onClick"])])])],2)))),128))]),(0,a.Lk)("div",Tn,[(0,a.bF)(f.D,{disabled:!i.listQuestion?.length,onClick:i.handleSubmitVote,color:"primary normal-case mb-[12px]"},{default:(0,a.k6)((()=>t[12]||(t[12]=[(0,a.eW)("Hoàn thành")]))),_:1},8,["disabled","onClick"])])])])}n(2577);var Rn={name:"AddNewStepTwo",emits:["submit"],components:{},props:{},setup(e,{emit:t}){const n=(0,r.Pj)(),l=(0,x.KR)(""),i=(0,x.KR)(null),s=(0,x.KR)(null),o=(0,x.KR)(null),u=(0,a.EW)({get:()=>n.getters["addnew/stepTwo"].questionTitle,set:e=>n.commit("addnew/setStepTwo",{field:"questionTitle",value:e})}),d=(0,a.EW)({get:()=>n.getters["addnew/stepTwo"].isMultiAnswer,set:e=>n.commit("addnew/setStepTwo",{field:"isMultiAnswer",value:e})}),c=(0,a.EW)({get:()=>n.getters["addnew/stepTwo"].isAnswerAddable,set:e=>n.commit("addnew/setStepTwo",{field:"isAnswerAddable",value:e})}),m=(0,a.EW)({get:()=>n.getters["addnew/stepTwo"].answers,set:e=>n.commit("addnew/setStepTwo",{field:"answers",value:e})}),p=(0,a.EW)({get:()=>n.getters["addnew/questions"],set:e=>n.commit("addnew/setQuestions",e)}),v=(0,a.EW)({get:()=>n.getters["addnew/stepTwo"].id,set:e=>n.commit("addnew/setStepTwo",{field:"id",value:e})});function f(){m.value.unshift(l.value),l.value="",i.value.focus()}function g(e){m.value.splice(e,1)}async function h(){if(await o.value.validate(),s.value){if(v.value){const e=p.value.find((e=>e.id==v.value));e.questionTitle=u.value,e.isMultiAnswer=d.value,e.isAnswerAddable=c.value,e.answers=[...m.value]}else p.value.unshift({questionTitle:u.value,isMultiAnswer:d.value,isAnswerAddable:c.value,answers:[...m.value],id:C.u.v1()});n.commit("addnew/resetCurrentQuestion")}}const w=[e=>!!c.value||(m.value?.length||"Cần nhập ít nhất 1 câu trả lời")];function b(e){p.value=p.value.filter((t=>t.id!=e))}function k(e){const t=p.value.find((t=>t.id==e));u.value=t.questionTitle,d.value=t.isMultiAnswer,m.value=[...t.answers],c.value=t.isAnswerAddable,v.value=e}function y(){n.commit("addnew/resetCurrentQuestion")}async function E(){n.commit("common/setIsLoading",!0);const e=n.getters["addnew/voteEntity"];var l=await ct.createAsync(e);n.commit("common/setIsLoading",!1),t("submit",l)}return{questionTitle:u,isMultiAnswer:d,isAnswerAddable:c,listAnswer:m,answerContent:l,addAnswer:f,answerContentRef:i,handleRemoveAnswer:g,requireStringRule:an,isFormAddQuestionValid:s,submitQuestion:h,formRef:o,validateAnswerRule:w,listQuestion:p,handleRemoveQuestion:b,handleEditQuestion:k,questionId:v,handleDiscardEdit:y,handleSubmitVote:E,commonFunction:D}}};const qn=(0,c.A)(Rn,[["render",In],["__scopeId","data-v-46ef1048"]]);var Fn=qn,_n={name:"AddNew",components:{StepByStep:Jt,AddNewStepOne:mn,AddNewStepTwo:Fn},setup(){const e=(0,j.rd)(),t=(0,x.KR)([{title:"Thiết lập bình xét"},{title:"Nhập nội dung câu hỏi"}]),n=(0,r.Pj)(),l=(0,x.KR)(!1),i=(0,x.KR)(0);async function s(t){if(i.value=i.value+1,l.value=!0,t.isSendQrEmail)await D.showDialog("Thông báo","Đường dẫn đến cuộc bình chọn đã được gửi vào Email",[{text:"Đóng",value:1,color:"primary"}]);else{await D.showPopup({component:kt,metaData:{voteID:t.voteID}})}n.commit("addnew/reset"),e.push(`/app/list?voteID=${t.voteID}`)}return(0,a.sV)((()=>{})),{steps:t,currentStepIndex:i,isDone:l,handleSubmitStepTwo:s}}};const Xn=(0,c.A)(_n,[["render",Nt],["__scopeId","data-v-8d652c6e"]]);var jn=Xn,Wn=n(552),Kn=n(9930);const Qn={class:"submit-wrapper w-full flex justify-center h-[100vh] px-4 py-3 flex-col items-center"},Nn={key:0},On={ref:"submitTitleRef",class:"submit-title mb-3"},Mn={class:"text-lg font-semibold"},Un={key:0},Bn={key:1,class:"mt-2"},Pn={ref:"submitContentRef",class:"submit-content px-3 py-2 rounded-md border border-[#ccc] overflow-auto flex flex-col gap-y-5"},$n={class:"flex items-start justify-start gap-x-2"},Jn={class:"ml-2"},Gn={class:"flex items-start justify-start submit-checkbox"},Hn={class:"flex items-center justify-between w-full"},zn={key:1},Yn={class:"flex items-start justify-start"},Zn={key:2},el=["onClick"],tl={class:"w-full flex gap-x-5 mt-3 justify-end items-center"};function nl(e,t,n,l,i,s){const o=(0,a.g2)("countdown-timer");return(0,a.uX)(),(0,a.CE)("div",Qn,[l.isSubmitted?((0,a.uX)(),(0,a.CE)("div",Nn,"Bạn đã gửi bình chọn")):((0,a.uX)(),(0,a.Wv)(zt.n,{key:1,modelValue:l.isFormValid,"onUpdate:modelValue":t[2]||(t[2]=e=>l.isFormValid=e),class:"h-full",ref:"formRef"},{default:(0,a.k6)((()=>[(0,a.Lk)("div",On,[(0,a.Lk)("div",Mn,"Bình chọn: "+(0,v.v_)(l.voteEntity?.voteTitle),1),l.emailEntity?((0,a.uX)(),(0,a.CE)("div",Un," Email: "+(0,v.v_)(l.emailEntity.emailAddress),1)):((0,a.uX)(),(0,a.CE)("div",Bn,[(0,a.bF)(Ke.W,{rules:l.ruleValidateSubmitterName,modelValue:l.submitModel.submitterName,"onUpdate:modelValue":t[0]||(t[0]=e=>l.submitModel.submitterName=e),placeholder:"Nhập họ và tên",clearable:""},null,8,["rules","modelValue"])]))],512),(0,a.Lk)("div",Pn,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(l.questionEntities,((e,n)=>((0,a.uX)(),(0,a.CE)("div",{key:e.questionID},[(0,a.Lk)("div",$n,[(0,a.Lk)("div",null,(0,v.v_)(n+1)+", ",1),(0,a.Lk)("div",null,(0,v.v_)(e.questionTitle),1)]),(0,a.Lk)("div",Jn,[e.isMultiAnswer?((0,a.uX)(),(0,a.CE)("div",{key:0,rules:[e=>"Chọn một đáp án"]},[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(e?.answers??[],((t,n)=>((0,a.uX)(),(0,a.CE)("div",{key:t.answerID},[(0,a.Lk)("div",Gn,[(0,a.Lk)("div",Hn,[(0,a.bF)(Ht.a,{"hide-details":n!=e?.answers?.length-1,label:t.answerContent,value:t.answerID,modelValue:l.submitModel.resultDetails[e.questionID],"onUpdate:modelValue":t=>l.submitModel.resultDetails[e.questionID]=t,rules:[e=>!!e?.length||"Chọn ít nhất một đáp án"]},null,8,["hide-details","label","value","modelValue","onUpdate:modelValue","rules"])])])])))),128))])):((0,a.uX)(),(0,a.CE)("div",zn,[(0,a.bF)(Kn.$,{rules:[e=>!!e||"Chọn một đáp án"],modelValue:l.submitModel.resultDetails[e.questionID],"onUpdate:modelValue":t=>l.submitModel.resultDetails[e.questionID]=t},{default:(0,a.k6)((()=>[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(e?.answers??[],(e=>((0,a.uX)(),(0,a.CE)("div",{key:e.answerID},[(0,a.Lk)("div",Yn,[(0,a.bF)(Wn.i,{label:e.answerContent,value:e.answerID},null,8,["label","value"])])])))),128))])),_:2},1032,["rules","modelValue","onUpdate:modelValue"])])),e.isAnswerAddable?((0,a.uX)(),(0,a.CE)("div",Zn,[(0,a.bF)(Je.y,{text:"Thêm mới câu trả lời"},{activator:(0,a.k6)((({props:n})=>[(0,a.Lk)("div",(0,a.v6)({onClick:t=>l.addNewAnswer(e),ref_for:!0},n,{class:"cursor-pointer w-8 h-8 flex items-center justify-center rounded-full border border-[#ccc] ml-2 mt-1"}),t[3]||(t[3]=[(0,a.Lk)("i",{class:"fa-solid fa-plus"},null,-1)]),16,el)])),_:2},1024)])):(0,a.Q3)("",!0)])])))),128))],512),(0,a.Lk)("div",tl,[l.voteEntity&&!l.isDisableSubmit?((0,a.uX)(),(0,a.Wv)(o,{key:0,isStoped:!1,modelValue:l.leftTime,"onUpdate:modelValue":t[1]||(t[1]=e=>l.leftTime=e),startTime:l.voteEntity?.createdDate,durationMinutes:l.voteEntity?.voteTime},null,8,["modelValue","startTime","durationMinutes"])):(0,a.Q3)("",!0),(0,a.bF)(f.D,{disabled:l.isDisableSubmit,color:"primary normal-case",onClick:l.submitForm},{default:(0,a.k6)((()=>t[4]||(t[4]=[(0,a.eW)("Hoàn thành")]))),_:1},8,["disabled","onClick"])])])),_:1},8,["modelValue"]))])}n(3949);const ll={class:"bg-white min-w-[330px] rounded-md px-3 py-2"},al={class:"text-lg font-semibold"},il={class:"flex justify-end gap-x-3 mt-2"};function sl(e,t,n,l,i,s){return(0,a.uX)(),(0,a.CE)("div",ll,[(0,a.Lk)("h1",al,(0,v.v_)(l.questionEntity.questionTitle),1),(0,a.bF)(zt.n,{modelValue:l.isFormValid,"onUpdate:modelValue":t[1]||(t[1]=e=>l.isFormValid=e),ref:"formRef"},{default:(0,a.k6)((()=>[(0,a.bF)(Ke.W,{class:"mt-2",rules:l.requireStringRule,ref:"answerContentRef",modelValue:l.answerContent,"onUpdate:modelValue":t[0]||(t[0]=e=>l.answerContent=e),placeholder:"Nội dung câu trả lời",clearable:""},null,8,["rules","modelValue"])])),_:1},8,["modelValue"]),(0,a.Lk)("div",il,[(0,a.bF)(f.D,{onClick:l.handleCancel,color:"secondary normal-case"},{default:(0,a.k6)((()=>t[2]||(t[2]=[(0,a.eW)("Hủy")]))),_:1},8,["onClick"]),(0,a.bF)(f.D,{onClick:l.handleSubmit,color:"primary normal-case"},{default:(0,a.k6)((()=>t[3]||(t[3]=[(0,a.eW)("Thêm mới")]))),_:1},8,["onClick"])])])}var ol={name:"AddNewAnswer",components:{},props:{popup:{type:Object,required:!0}},setup(e){const t=(0,x.KR)(),n=(0,x.KR)(),l=(0,x.KR)(),a=(0,x.KR)(!1);function i(){e.popup.visible=!1,e.popup.resolve("")}async function s(){await l.value.validate(),a.value&&(e.popup.visible=!1,e.popup.resolve(n.value))}return t.value=e.popup.metaData.questionEntity,{questionEntity:t,answerContent:n,requireStringRule:an,formRef:l,handleSubmit:s,handleCancel:i,isFormValid:a}}};const ul=(0,c.A)(ol,[["render",sl]]);var rl=ul;ae("answer");const dl=le("answer");var cl={async createMultiAsync(e){const{data:t}=await dl.post("/multi",e);return t}};ae("result");const ml=le("result");var pl={async createAsync(e){const{data:t}=await ml.post("/",e);return t}},vl={name:"SubmitPage",components:{CountdownTimer:ht},setup(){const e=(0,r.Pj)(),t=(0,j.lq)(),n=(0,x.KR)({voteID:null,emailID:null}),l=(0,x.KR)(null),i=(0,x.KR)(null),s=(0,x.KR)(null),o=(0,x.KR)(null),u=(0,x.KR)(null),d=(0,x.KR)(null),c=(0,x.KR)(null),m=(0,x.KR)({submitterName:null,resultDetails:{}}),p=(0,x.KR)(!1),v=(0,x.KR)(null);function f(){const e={};u.value.forEach((t=>{e[t.questionID]=t.isMultiAnswer?[]:null})),m.value={submitterName:null,resultDetails:e}}function g(){const e=d.value.clientHeight;c.value.style.height=window.innerHeight-e-100+"px"}async function h(){if(await l.value.validate(),i.value){let t=[];Object.entries(m.value.resultDetails).forEach((([e,n])=>{const l=u.value.filter((t=>t.questionID==e))[0];if(!l.isAnswerAddable)return;let a=l.answers.filter((e=>e.isAddNew));a=a.filter((e=>Array.isArray(n)?n.includes(e.answerID):n==e.answerID)),t=[...t,...a]})),e.commit("common/setIsLoading",!0),await cl.createMultiAsync(t);const l={submitterName:m.value.submitterName,voteID:s.value.voteID,emailID:o.value?.emailID};let a=[];Object.values(m.value.resultDetails).forEach((e=>{Array.isArray(e)?a=[...a,...e.map((e=>({answerID:e})))]:a.push({answerID:e})})),l.resultDetails=a,await pl.createAsync(l),e.commit("common/setIsLoading",!1),s.value=await ct.getEntireAsync(n.value.voteID),p.value=!0}}async function w(e){const t=await D.showPopup({component:rl,metaData:{questionEntity:e}});t&&e.answers.push({isCustom:!0,isAddNew:!0,answerContent:t,questionID:e.questionID,resultDetails:[],answerID:C.u.v1()})}n.value={emailID:t.query.emailID,voteID:t.params.id};const b=(0,a.EW)((()=>!s?.value||(0==v.value||(2==s.value?.voteStatus||s.value.totalJoiner<=s.value?.results?.length)))),k=(0,a.EW)((()=>{const e=n.value?.emailID;return e?null!=s.value?.results?.find((t=>t.emailID==e)):p.value}));(0,a.KC)((async()=>{s.value=await ct.getEntireAsync(n.value.voteID),n.value.emailID&&(o.value=s.value.emails.filter((e=>e.emailID==n.value.emailID))[0]),u.value=s.value.questions,f()})),(0,a.sV)((()=>{g()}));const y=[e=>!s.value?.isRequireName||!!e?.trim()?.length||"Không được để trống"];return{routeParam:n,voteEntity:s,emailEntity:o,questionEntities:u,ruleValidateSubmitterName:y,submitModel:m,submitForm:h,formRef:l,isFormValid:i,addNewAnswer:w,requireStringRule:an,submitTitleRef:d,submitContentRef:c,leftTime:v,isDisableSubmit:b,isSubmitted:k}}};const fl=(0,c.A)(vl,[["render",nl],["__scopeId","data-v-789f50ac"]]);var gl=fl;const hl=[{path:"/",name:"root",redirect:"/app"},{path:"/app",name:"MainLayout",component:Xe,redirect:"/app/list",children:[{path:"list",name:"list",component:jt},{path:"new",name:"new",component:jn}]},{path:"/login",name:"LoginPage",component:de},{path:"/submit/:id",name:"SubmitPage",component:gl}],wl=(0,j.aE)({history:(0,j.LA)("/"),routes:hl});var bl=wl,kl=(n(5524),n(5790)),yl=n(9616);const xl=(0,kl.$N)({icons:{defaultSet:"mdi",aliases:yl.z,sets:{mdi:yl.r}},theme:{defaultTheme:"light"}});var Cl=xl;(0,l.Ef)(X).use(ne).use(bl).use(Cl).mount("#app")}},t={};function n(l){var a=t[l];if(void 0!==a)return a.exports;var i=t[l]={exports:{}};return e[l].call(i.exports,i,i.exports,n),i.exports}n.m=e,function(){var e=[];n.O=function(t,l,a,i){if(!l){var s=1/0;for(d=0;d<e.length;d++){l=e[d][0],a=e[d][1],i=e[d][2];for(var o=!0,u=0;u<l.length;u++)(!1&i||s>=i)&&Object.keys(n.O).every((function(e){return n.O[e](l[u])}))?l.splice(u--,1):(o=!1,i<s&&(s=i));if(o){e.splice(d--,1);var r=a();void 0!==r&&(t=r)}}return t}i=i||0;for(var d=e.length;d>0&&e[d-1][2]>i;d--)e[d]=e[d-1];e[d]=[l,a,i]}}(),function(){n.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return n.d(t,{a:t}),t}}(),function(){n.d=function(e,t){for(var l in t)n.o(t,l)&&!n.o(e,l)&&Object.defineProperty(e,l,{enumerable:!0,get:t[l]})}}(),function(){n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){n.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){var e={524:0};n.O.j=function(t){return 0===e[t]};var t=function(t,l){var a,i,s=l[0],o=l[1],u=l[2],r=0;if(s.some((function(t){return 0!==e[t]}))){for(a in o)n.o(o,a)&&(n.m[a]=o[a]);if(u)var d=u(n)}for(t&&t(l);r<s.length;r++)i=s[r],n.o(e,i)&&e[i]&&e[i][0](),e[i]=0;return n.O(d)},l=self["webpackChunkvoting_app_fe"]=self["webpackChunkvoting_app_fe"]||[];l.forEach(t.bind(null,0)),l.push=t.bind(null,l.push.bind(l))}();var l=n.O(void 0,[504],(function(){return n(1931)}));l=n.O(l)})();